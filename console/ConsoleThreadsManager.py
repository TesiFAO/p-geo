from threading import Thread
from threading import Lock
import Queue
from ftplib import FTP
from utils import config
from console import console_processes
from console import threads_map_key
import os
import uuid
import time

exitFlag = 0


class LayerDownloadThread(Thread):

    layer_name = None
    source_name = None
    total_size = 0
    download_size = 0

    def __init__(self, source_name, product, year, day, thread_name, q, key):

        Thread.__init__(self)

        self.source_name = source_name
        self.thread_name = thread_name
        self.product = product
        self.year = year
        self.day = day
        self.config = config.Config(self.source_name)
        self.q = q
        self.key = key

    def run(self):

        print 'Run: ' + self.thread_name
        while not exitFlag:
            queueLock.acquire()
            if not workQueue.empty():
                self.layer_name = self.q.get()
                queueLock.release()
                ftp = FTP(self.config.get('ftp'))
                ftp.login()
                ftp.cwd(self.config.get('ftp_dir') + self.product + '/' + self.year + '/' + self.day + '/')
                ftp.sendcmd('TYPE i')
                self.total_size = ftp.size(self.layer_name)
                file = self.layer_name
                local_file = os.path.join(self.config.get('targetDir'), file)
                if not os.path.isfile(local_file):
                    try:
                        fileSize = os.stat(local_file).st_size
                        if fileSize < self.total_size:
                            with open(local_file, 'w') as f:
                                def callback(chunk):
                                    f.write(chunk)
                                    self.download_size += len(chunk)
                                    print self.key + ' Progress: ' + str(self.download_size)
                                ftp.retrbinary('RETR %s' %file, callback)
                    except:
                        with open(local_file, 'w') as f:
                            def callback(chunk):
                                f.write(chunk)
                                self.download_size += len(chunk)
                                print self.key + ' Progress of ' + self.layer_name + ': ' + str(self.download_size) + ' (processed by ' + self.thread_name + ')'
                            ftp.retrbinary('RETR %s' %file, callback)
                else:
                    self.download_size = self.total_size
                ftp.quit()
            else:
                queueLock.release()
            time.sleep(1)
        print 'End: ' + self.thread_name

    def percent_done(self):
        return float(self.download_size) / float(self.total_size) * 100


nameList = ["MOD13Q1.A2014001.h00v08.005.2014018085253.hdf", "MOD13Q1.A2014001.h00v09.005.2014018083640.hdf",
            "MOD13Q1.A2014001.h00v10.005.2014018080247.hdf", "MOD13Q1.A2014001.h01v07.005.2014018103544.hdf",
            "MOD13Q1.A2014001.h01v08.005.2014018083836.hdf", "MOD13Q1.A2014001.h01v09.005.2014018081258.hdf",
            "MOD13Q1.A2014001.h01v10.005.2014018082549.hdf", "MOD13Q1.A2014001.h01v11.005.2014018080405.hdf",
            "MOD13Q1.A2014001.h02v06.005.2014018102606.hdf", "MOD13Q1.A2014001.h02v08.005.2014018082809.hdf",
            "MOD13Q1.A2014001.h02v09.005.2014018084818.hdf", "MOD13Q1.A2014001.h02v10.005.2014018083516.hdf",
            "MOD13Q1.A2014001.h02v11.005.2014018083959.hdf", "MOD13Q1.A2014001.h03v06.005.2014018103704.hdf",
            "MOD13Q1.A2014001.h03v07.005.2014018102315.hdf", "MOD13Q1.A2014001.h03v09.005.2014018095548.hdf",
            "MOD13Q1.A2014001.h03v10.005.2014018082820.hdf", "MOD13Q1.A2014001.h03v11.005.2014018084848.hdf",
            "MOD13Q1.A2014001.h04v09.005.2014018081336.hdf", "MOD13Q1.A2014001.h04v10.005.2014018085914.hdf",
            "MOD13Q1.A2014001.h04v11.005.2014018100620.hdf", "MOD13Q1.A2014001.h05v10.005.2014018100337.hdf",
            "MOD13Q1.A2014001.h05v11.005.2014018103719.hdf", "MOD13Q1.A2014001.h05v13.005.2014018090415.hdf",
            "MOD13Q1.A2014001.h06v03.005.2014018075713.hdf", "MOD13Q1.A2014001.h06v11.005.2014018100424.hdf",
            "MOD13Q1.A2014001.h07v03.005.2014018090024.hdf", "MOD13Q1.A2014001.h07v05.005.2014018090020.hdf",
            "MOD13Q1.A2014001.h07v06.005.2014018090101.hdf", "MOD13Q1.A2014001.h07v07.005.2014018083627.hdf",
            "MOD13Q1.A2014001.h08v03.005.2014018122339.hdf", "MOD13Q1.A2014001.h08v04.005.2014018095147.hdf",
            "MOD13Q1.A2014001.h08v05.005.2014018102011.hdf", "MOD13Q1.A2014001.h08v06.005.2014018100406.hdf",
            "MOD13Q1.A2014001.h08v07.005.2014018102534.hdf", "MOD13Q1.A2014001.h08v08.005.2014018083201.hdf",
            "MOD13Q1.A2014001.h08v09.005.2014018083722.hdf", "MOD13Q1.A2014001.h08v11.005.2014018103227.hdf",
            "MOD13Q1.A2014001.h09v02.005.2014018081051.hdf", "MOD13Q1.A2014001.h09v03.005.2014018130118.hdf",
            "MOD13Q1.A2014001.h09v04.005.2014018102546.hdf", "MOD13Q1.A2014001.h09v05.005.2014018093619.hdf",
            "MOD13Q1.A2014001.h09v06.005.2014018095407.hdf", "MOD13Q1.A2014001.h09v07.005.2014018095143.hdf",
            "MOD13Q1.A2014001.h09v08.005.2014018082019.hdf", "MOD13Q1.A2014001.h09v09.005.2014018082253.hdf",
            "MOD13Q1.A2014001.h10v02.005.2014018100659.hdf", "MOD13Q1.A2014001.h10v03.005.2014018122614.hdf",
            "MOD13Q1.A2014001.h10v04.005.2014018095113.hdf", "MOD13Q1.A2014001.h10v05.005.2014018095025.hdf",
            "MOD13Q1.A2014001.h10v06.005.2014018090148.hdf", "MOD13Q1.A2014001.h10v07.005.2014018084024.hdf",
            "MOD13Q1.A2014001.h10v08.005.2014018090845.hdf", "MOD13Q1.A2014001.h10v09.005.2014018095633.hdf",
            "MOD13Q1.A2014001.h10v10.005.2014018083448.hdf", "MOD13Q1.A2014001.h10v11.005.2014018090632.hdf",
            "MOD13Q1.A2014001.h11v01.005.2014018074113.hdf", "MOD13Q1.A2014001.h11v02.005.2014018115449.hdf",
            "MOD13Q1.A2014001.h11v03.005.2014018135025.hdf", "MOD13Q1.A2014001.h11v04.005.2014018102706.hdf",
            "MOD13Q1.A2014001.h11v05.005.2014018100124.hdf", "MOD13Q1.A2014001.h11v06.005.2014018090930.hdf",
            "MOD13Q1.A2014001.h11v07.005.2014018092141.hdf", "MOD13Q1.A2014001.h11v08.005.2014018093407.hdf",
            "MOD13Q1.A2014001.h11v09.005.2014018093529.hdf", "MOD13Q1.A2014001.h11v10.005.2014018093157.hdf",
            "MOD13Q1.A2014001.h11v11.005.2014018092301.hdf", "MOD13Q1.A2014001.h11v12.005.2014018085729.hdf",
            "MOD13Q1.A2014001.h12v01.005.2014018105359.hdf", "MOD13Q1.A2014001.h12v02.005.2014018121258.hdf",
            "MOD13Q1.A2014001.h12v03.005.2014018170235.hdf", "MOD13Q1.A2014001.h12v04.005.2014018100534.hdf",
            "MOD13Q1.A2014001.h12v05.005.2014018090527.hdf", "MOD13Q1.A2014001.h12v07.005.2014018112521.hdf",
            "MOD13Q1.A2014001.h12v08.005.2014018091149.hdf", "MOD13Q1.A2014001.h12v09.005.2014018091303.hdf",
            "MOD13Q1.A2014001.h12v10.005.2014018091447.hdf", "MOD13Q1.A2014001.h12v11.005.2014018094457.hdf",
            "MOD13Q1.A2014001.h12v12.005.2014018101955.hdf", "MOD13Q1.A2014001.h12v13.005.2014018091950.hdf",
            "MOD13Q1.A2014001.h13v01.005.2014018075154.hdf", "MOD13Q1.A2014001.h13v02.005.2014018122350.hdf",
            "MOD13Q1.A2014001.h13v03.005.2014018120646.hdf", "MOD13Q1.A2014001.h13v04.005.2014018093615.hdf",
            "MOD13Q1.A2014001.h13v08.005.2014018084601.hdf", "MOD13Q1.A2014001.h13v09.005.2014018093701.hdf",
            "MOD13Q1.A2014001.h13v10.005.2014018095658.hdf", "MOD13Q1.A2014001.h13v11.005.2014018093608.hdf",
            "MOD13Q1.A2014001.h13v12.005.2014018093946.hdf", "MOD13Q1.A2014001.h13v13.005.2014018102038.hdf",
            "MOD13Q1.A2014001.h13v14.005.2014018123351.hdf", "MOD13Q1.A2014001.h14v01.005.2014018075745.hdf",
            "MOD13Q1.A2014001.h14v02.005.2014018164730.hdf", "MOD13Q1.A2014001.h14v03.005.2014018130441.hdf",
            "MOD13Q1.A2014001.h14v04.005.2014018095332.hdf", "MOD13Q1.A2014001.h14v09.005.2014018091029.hdf",
            "MOD13Q1.A2014001.h14v10.005.2014018090501.hdf", "MOD13Q1.A2014001.h14v11.005.2014018090657.hdf",
            "MOD13Q1.A2014001.h14v14.005.2014018130431.hdf", "MOD13Q1.A2014001.h15v01.005.2014018075848.hdf",
            "MOD13Q1.A2014001.h15v02.005.2014018122831.hdf", "MOD13Q1.A2014001.h15v03.005.2014018113522.hdf",
            "MOD13Q1.A2014001.h15v05.005.2014018091954.hdf", "MOD13Q1.A2014001.h15v07.005.2014018085043.hdf",
            "MOD13Q1.A2014001.h15v11.005.2014018090203.hdf", "MOD13Q1.A2014001.h15v14.005.2014018095235.hdf",
            "MOD13Q1.A2014001.h16v01.005.2014018075253.hdf", "MOD13Q1.A2014001.h16v02.005.2014018150147.hdf",
            "MOD13Q1.A2014001.h16v05.005.2014018090135.hdf", "MOD13Q1.A2014001.h16v06.005.2014018091203.hdf",
            "MOD13Q1.A2014001.h16v07.005.2014018092323.hdf", "MOD13Q1.A2014001.h16v08.005.2014018094530.hdf",
            "MOD13Q1.A2014001.h16v09.005.2014018085926.hdf", "MOD13Q1.A2014001.h16v12.005.2014018090644.hdf",
            "MOD13Q1.A2014001.h16v14.005.2014018171559.hdf", "MOD13Q1.A2014001.h17v01.005.2014018075129.hdf",
            "MOD13Q1.A2014001.h17v02.005.2014018113550.hdf", "MOD13Q1.A2014001.h17v03.005.2014018125629.hdf",
            "MOD13Q1.A2014001.h17v04.005.2014018104155.hdf", "MOD13Q1.A2014001.h17v05.005.2014018093700.hdf",
            "MOD13Q1.A2014001.h17v06.005.2014018093533.hdf", "MOD13Q1.A2014001.h17v07.005.2014018093346.hdf",
            "MOD13Q1.A2014001.h17v08.005.2014018093753.hdf", "MOD13Q1.A2014001.h17v10.005.2014018085717.hdf",
            "MOD13Q1.A2014001.h17v12.005.2014018085624.hdf", "MOD13Q1.A2014001.h17v13.005.2014018091154.hdf",
            "MOD13Q1.A2014001.h18v01.005.2014018075457.hdf", "MOD13Q1.A2014001.h18v02.005.2014018145757.hdf",
            "MOD13Q1.A2014001.h18v03.005.2014018124906.hdf", "MOD13Q1.A2014001.h18v04.005.2014018103601.hdf",
            "MOD13Q1.A2014001.h18v05.005.2014018091912.hdf", "MOD13Q1.A2014001.h18v06.005.2014018093015.hdf",
            "MOD13Q1.A2014001.h18v07.005.2014018092144.hdf", "MOD13Q1.A2014001.h18v08.005.2014018093013.hdf",
            "MOD13Q1.A2014001.h18v09.005.2014018084541.hdf", "MOD13Q1.A2014001.h18v14.005.2014018121405.hdf",
            "MOD13Q1.A2014001.h19v01.005.2014018075325.hdf", "MOD13Q1.A2014001.h19v02.005.2014018153627.hdf",
            "MOD13Q1.A2014001.h19v03.005.2014018130843.hdf", "MOD13Q1.A2014001.h19v04.005.2014018124504.hdf",
            "MOD13Q1.A2014001.h19v05.005.2014018114348.hdf", "MOD13Q1.A2014001.h19v06.005.2014018101215.hdf",
            "MOD13Q1.A2014001.h19v07.005.2014018121902.hdf", "MOD13Q1.A2014001.h19v08.005.2014018093711.hdf",
            "MOD13Q1.A2014001.h19v09.005.2014018094158.hdf", "MOD13Q1.A2014001.h19v10.005.2014018091242.hdf",
            "MOD13Q1.A2014001.h19v11.005.2014018090333.hdf", "MOD13Q1.A2014001.h19v12.005.2014018092212.hdf",
            "MOD13Q1.A2014001.h20v01.005.2014018075506.hdf", "MOD13Q1.A2014001.h20v02.005.2014018121801.hdf",
            "MOD13Q1.A2014001.h20v03.005.2014018130345.hdf", "MOD13Q1.A2014001.h20v04.005.2014018095007.hdf",
            "MOD13Q1.A2014001.h20v05.005.2014018093212.hdf", "MOD13Q1.A2014001.h20v06.005.2014018094201.hdf",
            "MOD13Q1.A2014001.h20v07.005.2014018100607.hdf", "MOD13Q1.A2014001.h20v08.005.2014018094336.hdf",
            "MOD13Q1.A2014001.h20v09.005.2014018092238.hdf", "MOD13Q1.A2014001.h20v10.005.2014018095804.hdf",
            "MOD13Q1.A2014001.h20v11.005.2014018102927.hdf", "MOD13Q1.A2014001.h20v12.005.2014018124436.hdf",
            "MOD13Q1.A2014001.h20v13.005.2014018122434.hdf", "MOD13Q1.A2014001.h21v01.005.2014018081749.hdf",
            "MOD13Q1.A2014001.h21v02.005.2014018211434.hdf", "MOD13Q1.A2014001.h21v03.005.2014018131521.hdf",
            "MOD13Q1.A2014001.h21v04.005.2014018125119.hdf", "MOD13Q1.A2014001.h21v05.005.2014018101524.hdf",
            "MOD13Q1.A2014001.h21v06.005.2014018102126.hdf", "MOD13Q1.A2014001.h21v07.005.2014018094825.hdf",
            "MOD13Q1.A2014001.h21v08.005.2014018130815.hdf", "MOD13Q1.A2014001.h21v09.005.2014018094215.hdf",
            "MOD13Q1.A2014001.h21v10.005.2014018125752.hdf", "MOD13Q1.A2014001.h21v11.005.2014018092840.hdf",
            "MOD13Q1.A2014001.h21v13.005.2014018124100.hdf", "MOD13Q1.A2014001.h22v01.005.2014018081329.hdf",
            "MOD13Q1.A2014001.h22v02.005.2014018190349.hdf", "MOD13Q1.A2014001.h22v03.005.2014018172443.hdf",
            "MOD13Q1.A2014001.h22v04.005.2014018125158.hdf", "MOD13Q1.A2014001.h22v05.005.2014018103952.hdf",
            "MOD13Q1.A2014001.h22v06.005.2014018092915.hdf", "MOD13Q1.A2014001.h22v07.005.2014018091653.hdf",
            "MOD13Q1.A2014001.h22v08.005.2014018125939.hdf", "MOD13Q1.A2014001.h22v09.005.2014018094104.hdf",
            "MOD13Q1.A2014001.h22v10.005.2014018124631.hdf", "MOD13Q1.A2014001.h22v11.005.2014018114130.hdf",
            "MOD13Q1.A2014001.h22v13.005.2014018152342.hdf", "MOD13Q1.A2014001.h22v14.005.2014018163838.hdf",
            "MOD13Q1.A2014001.h23v01.005.2014018082240.hdf", "MOD13Q1.A2014001.h23v02.005.2014018183821.hdf",
            "MOD13Q1.A2014001.h23v03.005.2014018162558.hdf", "MOD13Q1.A2014001.h23v04.005.2014018130438.hdf",
            "MOD13Q1.A2014001.h23v05.005.2014018120706.hdf", "MOD13Q1.A2014001.h23v06.005.2014018115702.hdf",
            "MOD13Q1.A2014001.h23v07.005.2014018111439.hdf", "MOD13Q1.A2014001.h23v08.005.2014018090355.hdf",
            "MOD13Q1.A2014001.h23v09.005.2014018093102.hdf", "MOD13Q1.A2014001.h23v10.005.2014018091008.hdf",
            "MOD13Q1.A2014001.h23v11.005.2014018111918.hdf", "MOD13Q1.A2014001.h24v01.005.2014018080328.hdf",
            "MOD13Q1.A2014001.h24v02.005.2014018173047.hdf", "MOD13Q1.A2014001.h24v03.005.2014018203707.hdf",
            "MOD13Q1.A2014001.h24v04.005.2014018133119.hdf", "MOD13Q1.A2014001.h24v05.005.2014018103036.hdf",
            "MOD13Q1.A2014001.h24v06.005.2014018120519.hdf", "MOD13Q1.A2014001.h24v07.005.2014018111605.hdf",
            "MOD13Q1.A2014001.h24v12.005.2014018125903.hdf", "MOD13Q1.A2014001.h25v02.005.2014018130625.hdf",
            "MOD13Q1.A2014001.h25v03.005.2014018172834.hdf", "MOD13Q1.A2014001.h25v04.005.2014018135525.hdf",
            "MOD13Q1.A2014001.h25v05.005.2014018131529.hdf", "MOD13Q1.A2014001.h25v06.005.2014018123023.hdf",
            "MOD13Q1.A2014001.h25v07.005.2014018114826.hdf", "MOD13Q1.A2014001.h25v08.005.2014018123343.hdf",
            "MOD13Q1.A2014001.h25v09.005.2014018123914.hdf", "MOD13Q1.A2014001.h26v02.005.2014018103010.hdf",
            "MOD13Q1.A2014001.h26v03.005.2014018193043.hdf", "MOD13Q1.A2014001.h26v04.005.2014018163538.hdf",
            "MOD13Q1.A2014001.h26v05.005.2014018191755.hdf", "MOD13Q1.A2014001.h26v06.005.2014018122859.hdf",
            "MOD13Q1.A2014001.h26v07.005.2014018112153.hdf", "MOD13Q1.A2014001.h26v08.005.2014018132407.hdf",
            "MOD13Q1.A2014001.h27v03.005.2014018163639.hdf", "MOD13Q1.A2014001.h27v04.005.2014018145706.hdf",
            "MOD13Q1.A2014001.h27v05.005.2014018140029.hdf", "MOD13Q1.A2014001.h27v06.005.2014018121807.hdf",
            "MOD13Q1.A2014001.h27v07.005.2014018121017.hdf", "MOD13Q1.A2014001.h27v08.005.2014018112810.hdf",
            "MOD13Q1.A2014001.h27v09.005.2014018113044.hdf", "MOD13Q1.A2014001.h27v10.005.2014018120018.hdf",
            "MOD13Q1.A2014001.h27v11.005.2014018120551.hdf", "MOD13Q1.A2014001.h27v12.005.2014018145429.hdf",
            "MOD13Q1.A2014001.h27v14.005.2014018125631.hdf", "MOD13Q1.A2014001.h28v03.005.2014018115249.hdf",
            "MOD13Q1.A2014001.h28v04.005.2014018174926.hdf", "MOD13Q1.A2014001.h28v05.005.2014018161156.hdf",
            "MOD13Q1.A2014001.h28v06.005.2014018122057.hdf", "MOD13Q1.A2014001.h28v07.005.2014018122825.hdf",
            "MOD13Q1.A2014001.h28v08.005.2014018112707.hdf", "MOD13Q1.A2014001.h28v09.005.2014018125832.hdf",
            "MOD13Q1.A2014001.h28v10.005.2014018115247.hdf", "MOD13Q1.A2014001.h28v11.005.2014018130028.hdf",
            "MOD13Q1.A2014001.h28v12.005.2014018114940.hdf", "MOD13Q1.A2014001.h28v13.005.2014018131032.hdf",
            "MOD13Q1.A2014001.h28v14.005.2014018125604.hdf", "MOD13Q1.A2014001.h29v03.005.2014018084056.hdf",
            "MOD13Q1.A2014001.h29v05.005.2014018161945.hdf", "MOD13Q1.A2014001.h29v06.005.2014018141516.hdf",
            "MOD13Q1.A2014001.h29v07.005.2014018125910.hdf", "MOD13Q1.A2014001.h29v08.005.2014018142352.hdf",
            "MOD13Q1.A2014001.h29v09.005.2014018142259.hdf", "MOD13Q1.A2014001.h29v10.005.2014018143216.hdf",
            "MOD13Q1.A2014001.h29v11.005.2014018154342.hdf", "MOD13Q1.A2014001.h29v12.005.2014018143325.hdf",
            "MOD13Q1.A2014001.h29v13.005.2014018145816.hdf", "MOD13Q1.A2014001.h30v05.005.2014018143749.hdf",
            "MOD13Q1.A2014001.h30v06.005.2014018141401.hdf", "MOD13Q1.A2014001.h30v07.005.2014018172723.hdf",
            "MOD13Q1.A2014001.h30v08.005.2014018140849.hdf", "MOD13Q1.A2014001.h30v09.005.2014018142623.hdf",
            "MOD13Q1.A2014001.h30v10.005.2014018133221.hdf", "MOD13Q1.A2014001.h30v11.005.2014018181302.hdf",
            "MOD13Q1.A2014001.h30v12.005.2014018121226.hdf", "MOD13Q1.A2014001.h30v13.005.2014018141823.hdf",
            "MOD13Q1.A2014001.h31v06.005.2014018172823.hdf", "MOD13Q1.A2014001.h31v07.005.2014018141406.hdf",
            "MOD13Q1.A2014001.h31v08.005.2014018140551.hdf", "MOD13Q1.A2014001.h31v09.005.2014018145321.hdf",
            "MOD13Q1.A2014001.h31v10.005.2014018153847.hdf", "MOD13Q1.A2014001.h31v11.005.2014018150925.hdf",
            "MOD13Q1.A2014001.h31v12.005.2014018144147.hdf", "MOD13Q1.A2014001.h31v13.005.2014018094019.hdf",
            "MOD13Q1.A2014001.h32v07.005.2014018155604.hdf", "MOD13Q1.A2014001.h32v08.005.2014018152925.hdf",
            "MOD13Q1.A2014001.h32v09.005.2014018160834.hdf", "MOD13Q1.A2014001.h32v10.005.2014018154056.hdf",
            "MOD13Q1.A2014001.h32v11.005.2014018144958.hdf", "MOD13Q1.A2014001.h32v12.005.2014018150911.hdf",
            "MOD13Q1.A2014001.h33v07.005.2014018160120.hdf", "MOD13Q1.A2014001.h33v08.005.2014018155532.hdf",
            "MOD13Q1.A2014001.h33v09.005.2014018160016.hdf", "MOD13Q1.A2014001.h33v10.005.2014018160334.hdf",
            "MOD13Q1.A2014001.h33v11.005.2014018145545.hdf", "MOD13Q1.A2014001.h34v07.005.2014018155044.hdf",
            "MOD13Q1.A2014001.h34v08.005.2014018142843.hdf", "MOD13Q1.A2014001.h34v09.005.2014018151338.hdf",
            "MOD13Q1.A2014001.h34v10.005.2014018160921.hdf", "MOD13Q1.A2014001.h35v08.005.2014018140548.hdf",
            "MOD13Q1.A2014001.h35v09.005.2014018155711.hdf", "MOD13Q1.A2014001.h35v10.005.2014018135802.hdf"]
threadList = ['Alpha', 'Bravo', 'Charlie', 'Delta', 'Echo', 'Foxtrot', 'Golf', 'Hotel', 'India', 'Juliet', 'Kilo']
queueLock = Lock()
workQueue = Queue.Queue(len(nameList))
threads = []

for tName in threadList:
    key = uuid.uuid4()
    thread = LayerDownloadThread('MODIS', 'MOD13Q1', '2014', '001', tName, workQueue, key)
    thread.start()
    if not threads_map_key in console_processes:
        console_processes[threads_map_key] = {}
    console_processes[threads_map_key][key] = thread
    threads.append(thread)

queueLock.acquire()
for word in nameList:
    workQueue.put(word)
queueLock.release()

while not workQueue.empty():
    pass

exitFlag = 1

for t in threads:
    t.join()
print "Exiting Main Thread"